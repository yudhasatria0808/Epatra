@model ePatria.Models.Walktrough

@{
    ViewBag.Title = "Create";
}
@using Microsoft.AspNet.Identity;
@{ var checkPerm = HelperController.getPermissionRoleByPerm("BPM", User.Identity.GetUserId()); }
@{ var Perm = HelperController.getPermission(User.Identity.GetUserId(), "BPM"); }
@{ var empName = HelperController.getNameByUserName(User.Identity.Name);
    var isSuperAdmin = HelperController.isSuperAdmin(User.Identity.GetUserId());
}

@using (Html.BeginForm("CreateBusiness", "Walktroughs", FormMethod.Post, new { enctype = "multipart/form-data", id="businessform" }))
{
    @Html.AntiForgeryToken()
    <div class="form-horizontal">
        <h4>BPM (Business Process Model)</h4>
        <hr />
        <div class="error-container">
            <ul></ul>
        </div>
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        @Html.Hidden("WalktroughID")
        @Html.Hidden("BPMID")
        @Html.Hidden("PrelimID")

        <div class="form-group">
            @Html.Label("No.Document", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-5">
                @Html.Editor("DocumentNo", new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Document Name", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-5">
                @Html.Editor("DocumentName", new { htmlAttributes = new { @class = "form-control" } })
            </div>
        </div>


        <div class="form-group">
            @Html.Label("Folder", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-5">
                @Html.DropDownList("FolderName", new List<SelectListItem>
                        {
                        new SelectListItem{ Text="Preparation", Value = "Preparation" },
                        new SelectListItem{ Text="Field Work", Value = "Field Work" },
                        new SelectListItem{ Text="Issue", Value = "Issue" },
                        new SelectListItem{ Text="Followup", Value = "Followup" }
                        }, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessage("FolderName", "", new { @class = "text-danger" })
            </div>
        </div>


        <div class="form-group">
            @Html.Label("File", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                <input type="file" name="files" id="file1" class="file1" />
                <div class="preview"></div>
            </div>
        </div>

        <script>
            $(function () {
                $("input[name=files]").previewimage({
                    div: ".preview"
                });
            });
        </script>
        <style type="text/css">
            input[type='file'] {
                color: transparent;
            }
        </style>

        @if (Perm != null && Perm.Any(q => q.IsUpdate == true) || isSuperAdmin)
        {
            if (ViewBag.BPMStatus == "Draft")
            {
                <div class="form-group">
                    <div class="col-md-offset-2 col-md-10">
                        <input type="submit" value="Create" class="btn btn-default" />
                    </div>
                </div>
            }
        }
    </div>
}
<hr />
<div class="row" style="margin-top:20px;">
    <div class="col-md-12">
        <!-- BEGIN EXAMPLE TABLE PORTLET-->
        <div class="portlet box red-sunglo">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-user"></i> Business Process
                </div>
            </div>
            <div class="portlet-body">
             
                <table class="table table-striped table-hover table-bordered" id="table-employee">
                    <thead>
                        <tr>
                            <th>
                                No Document
                            </th>
                            <th>
                                Name Document
                            </th>
                            <th>
                                Remarks
                            </th>
                            <th>
                                Action
                            </th>
                        </tr>
                    </thead>

                    <tbody>
                        @foreach (var busines in Model.BusinessProces)
                            {
                            <tr>
                                <td>
                                    @Html.DisplayFor(model => busines.DocumentNo)
                                </td>
                                <td>
                                    @Html.DisplayFor(model => busines.DocumentName)
                                </td>
                                <td>
                                    @Html.DisplayFor(model => busines.Walktrough.Remarks)
                                </td>
                                @if (Perm != null && Perm.Any(q => q.IsUpdate == true) || isSuperAdmin) {
                                    if (ViewBag.BPMStatus == "Draft" || ViewBag.BPMStatus == "Pending for Review by " + checkPerm.Split(':')[1].Split(';')[0])
                                    {
                                        <td>
                                           @Html.ActionLink("Edit", "EditBusiness", new { id = busines.BusinessProcesID, walkid = busines.WalktroughID }) |
                                           @Html.ActionLink("Details", "Details", new { id = busines.BusinessProcesID }) |
                                           @Html.ActionLink("Delete", "Delete", new { id = busines.BusinessProcesID })
                                        </td>
                                    } else {
                                        <td>@Html.ActionLink("Details", "Details", new { id = busines.BusinessProcesID })</td>
                                    }
                                } else {
                                    <td>@Html.ActionLink("Details", "Details", new { id = busines.BusinessProcesID })</td>
                                }
                                
                            </tr>
                            }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="btn-group pull-right">
    @using (Html.BeginForm("UpdateBPM", "Walktroughs", "POST"))
    {
        @Html.AntiForgeryToken()
        @Html.Hidden("BPMID")
        @Html.Hidden("WalktroughID")
        @Html.Hidden("PrelimID")
        foreach (var bpms in Model.BPM)
        {
            if (checkPerm.Contains("IsSubmit1"))
            {
                if (Perm != null && Perm.Any(q => q.IsSubmit1 == true) || isSuperAdmin)
                {
                    if (bpms.Status == "Pending for Review by " + checkPerm.Split(':')[1].Split(';')[0])
                    {
                        if (checkPerm.Split(':')[1].Split(';')[0] == "Member")
                        {
                            if (bpms.Walktrough.Preliminary.MemberID != null)
                            {
                                if (bpms.Walktrough.Preliminary.MemberID.Contains(empName) || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsSubmit2"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                    else if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                }
                            }
                            else
                            {
                                                                    if (checkPerm.Contains("IsSubmit2"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                                else if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                            }
                        }
                        if (checkPerm.Split(':')[1].Split(';')[0] == "Ketua Tim")
                        {
                            if (bpms.Walktrough.Preliminary.TeamLeaderID != null)
                            {
                                if (bpms.Walktrough.Preliminary.TeamLeaderID == empName || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsSubmit2"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                    else if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                }
                            }
                            else
                            {
                                                                if (checkPerm.Contains("IsSubmit2"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                                else if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                            }
                        }
                        if (checkPerm.Split(':')[1].Split(';')[0] == "Pengawas")
                        {
                            if (bpms.Walktrough.Preliminary.SupervisorID != null)
                            {
                                if (bpms.Walktrough.Preliminary.SupervisorID == empName || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsSubmit2"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                    else if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                }
                            }
                            else
                            {
                                                                if (checkPerm.Contains("IsSubmit2"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                                else if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                            }
                        }
                        if (checkPerm.Split(':')[1].Split(';')[0] == "CIA")
                        {
                            if (bpms.Walktrough.Preliminary.PICID != null)
                            {
                                if (bpms.Walktrough.Preliminary.PICID == empName || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsSubmit2"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                    else if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                    }
                                }
                            }
                            else
                            {
                                                                if (checkPerm.Contains("IsSubmit2"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                                else if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />*@
                                }
                            }
                        }
                    }
                }
            }
            if (checkPerm.Contains("IsSubmit2"))
            {
                if (Perm != null && Perm.Any(q => q.IsSubmit2 == true) || isSuperAdmin)
                {
                    if (bpms.Status == "Pending for Review by " + checkPerm.Split(':')[2].Split(';')[0])
                    {
                        if (checkPerm.Split(':')[2].Split(';')[0] == "Member")
                        {
                            if (bpms.Walktrough.Preliminary.MemberID != null)
                            {
                                if (bpms.Walktrough.Preliminary.MemberID.Contains(empName) || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                            <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                        }
                                    }
                                }
                            }
                            else
                            {
                                if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                        <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                    }
                                }
                            }
                        }
                        if (checkPerm.Split(':')[2].Split(';')[0] == "Ketua Tim")
                        {
                            if (bpms.Walktrough.Preliminary.TeamLeaderID != null)
                            {
                                if (bpms.Walktrough.Preliminary.TeamLeaderID == empName || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                            <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                        }
                                    }
                                }
                            }
                            else
                            {
                                if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                        <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                    }
                                }
                            }
                        }
                        if (checkPerm.Split(':')[2].Split(';')[0] == "Pengawas")
                        {
                            if (bpms.Walktrough.Preliminary.SupervisorID != null)
                            {
                                if (bpms.Walktrough.Preliminary.SupervisorID == empName || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                            <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                        }
                                    }
                                }
                            }
                            else
                            {
                                if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                        <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                    }
                                }
                            }
                        }
                        if (checkPerm.Split(':')[2].Split(';')[0] == "CIA")
                        {
                            if (bpms.Walktrough.Preliminary.PICID != null)
                            {
                                if (bpms.Walktrough.Preliminary.PICID == empName || isSuperAdmin)
                                {
                                    if (checkPerm.Contains("IsApprove"))
                                    {
                                        <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                        if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                            <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                        }
                                    }
                                }
                            }
                            else
                            {
                                if (checkPerm.Contains("IsApprove"))
                                {
                                    <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>
                                    @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                                    if (checkPerm.Split(':')[1].Split(';')[0] != checkPerm.Split(':')[2].Split(';')[0]) {
                                        <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                    }
                                }
                            }
                        }
                    }
                }
            }
            if (checkPerm.Contains("IsApprove"))
            {
                if (Perm != null && Perm.Any(q => q.IsApprove == true) || isSuperAdmin)
                {
                    if (bpms.Status == "Pending for Approve by " + checkPerm.Split(':')[3].Split(';')[0])
                    {
                        if (checkPerm.Split(':')[3].Split(';')[0] == "Member")
                        {
                            if (bpms.Walktrough.Preliminary.MemberID != null)
                            {
                                if (bpms.Walktrough.Preliminary.MemberID.Contains(empName) || isSuperAdmin)
                                {
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                }
                            } else {
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                            }
                        }
                        if (checkPerm.Split(':')[3].Split(';')[0] == "Ketua Tim")
                        {
                            if (bpms.Walktrough.Preliminary.TeamLeaderID != null)
                            {
                                if (bpms.Walktrough.Preliminary.TeamLeaderID == empName || isSuperAdmin)
                                {
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                }
                            } else {
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                            }
                        }
                        if (checkPerm.Split(':')[3].Split(';')[0] == "Pengawas")
                        {
                            if (bpms.Walktrough.Preliminary.SupervisorID != null)
                            {
                                if (bpms.Walktrough.Preliminary.SupervisorID == empName || isSuperAdmin)
                                {
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                }
                            } else {
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                            }
                        }
                        if (checkPerm.Split(':')[3].Split(';')[0] == "CIA")
                        {
                            if (bpms.Walktrough.Preliminary.PICID != null)
                            {
                                if (bpms.Walktrough.Preliminary.PICID == empName || isSuperAdmin)
                                {
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                                }
                            } else {
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Approve" />
                                <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Send Back" />
                            }
                        }
                    }
                }
            }
            if (Perm != null && Perm.Any(q => q.IsUpdate == true) || isSuperAdmin)
            {
                if (bpms.Status == "Draft")
                {
                    if (Perm.Any(d => d.IsCreate))
                    {
                        if (Perm.Any(d => d.IsSubmit1))
                        {
                            if (checkPerm.Contains("IsSubmit2"))
                            {
                                <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]"> Submit</button>
                            }
                            else if (checkPerm.Contains("IsApprove"))
                            {
                                <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]"> Submit</button>
                            }
                        }
                        else
                        {
                            <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[1].Split(';')[0]"> Submit</button>
                        }
                    }
                    else if (Perm.Any(d => d.IsSubmit1))
                    {
                        if (checkPerm.Contains("IsSubmit2"))
                        {
                            <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]"> Submit</button>
                        }
                        else if (checkPerm.Contains("IsApprove"))
                        {
                            <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]"> Submit</button>
                        }
                    }
                    else if (Perm.Any(d => d.IsSubmit2))
                    {
                        if (checkPerm.Contains("IsApprove"))
                        {
                            <button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]"> Submit</button>
                        }
                    }

                    if (checkPerm.Contains("IsSubmit1"))
                    {
                        @*<button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[1].Split(';')[0]">Submit</button>*@
                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[1].Split(';')[0]" />*@
                    }
                    else if (checkPerm.Contains("IsSubmit2"))
                    {
                        @*<button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]">Submit</button>*@
                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Review By @checkPerm.Split(':')[2].Split(';')[0]" />*@
                    }
                    else if (checkPerm.Contains("IsApprove"))
                    {
                        @*<button class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]">Submit</button>*@
                        @*<input class="btn btn-primary" name="submit" type="submit" id="submit" value="Submit For Approve By @checkPerm.Split(':')[3].Split(';')[0]" />*@
                    }
                    <input class="btn btn-primary" name="submit" type="submit" id="submit" value="Save" />
                }
            }
        }
    }
</div>


    <div>
        <a href="@Url.Action("Create", "Walktroughs", new { id = Model.WalktroughID })">Back to List</a>
            @*@Html.ActionLink("Back to List", "Create", new object { id })WalktroughID*@
</div>
    @section Scripts {
        @Scripts.Render("~/bundles/jqueryval")
        @if (ViewBag.message != null)
        {
            <script>
                $(document).ready(function () {
                    toastr.success("@ViewBag.message", "Success");
                });
            </script>
        }
        <script src="~/Scripts/jquery.autosize-min.js"></script>
        <script src="~/Scripts/jquery.timeago.js"></script>
        <script src="~/Scripts/knockout-3.4.0.js"></script>
        <script src="~/Scripts/wallpost.js"></script>
        <script>
            $("#businessform").validate({
                errorLabelContainer: $("ul", $('div.error-container')),
                wrapper: 'li',
                rules: {
                    DocumentNo: "required",
                    DocumentName: "required",
                },
                messages: {
                    DocumentNo: "Please enter Document No",
                    DocumentName: "Please enter Document Name"
                }
            });
        </script>
    }

    <script>
        $(document).ready(function () {
            $('#table-employee').DataTable();
        });
    </script>


    <h2>Review Notes</h2>

    @*<div class="col-md-6">
        <div class="input-group">*@
    <div class="publishContainer">
        <textarea class="msgTextArea" id="txtMessage" data-bind="value: newMessage, jqAutoresize: {}" style="height:3em;" placeholder="Write your comment..."></textarea>
        <div class="btn-group ">
            <button class="btn btn-primary btn-lg" data-url="/Wall/SavePost" value="Comment" id="btnShare" data-bind="click: addPost">Comment</button>
            <input type="hidden" data-bind="value: apmId" class="apmId" value="@Model.BPM.Select(model=>model.BPMID).FirstOrDefault()" />
            @{
                int apmId = Model.BPM.Select(model => model.BPMID).FirstOrDefault();
            }
            <script>
                localStorage.apmId = 'bpm' + '@apmId';
            </script>
        </div>
    </div>
    <ul id="msgHolder" data-bind="foreach: posts">
        <li class="postHolder">
            <img data-bind="attr: { src: '../../Content/assets/global/img/avatar3_small.jpg' }"><a data-bind="text: PostedByName"></a>: <span data-bind="html: Message"></span>
            <div class="postFooter">
                <span class="timeago" data-bind="text: PostedDate"></span>&nbsp;<a class="linkComment" href="#" data-bind="click: toggleComment">Reply</a>
                <div class="commentSection">
                    <ul data-bind="foreach: PostComments">
                        <li class="commentHolder">
                            <img data-bind="attr: { src: '../../Content/assets/global/img/avatar3_small.jpg' }"><a data-bind="text: CommentedByName"></a>: <span data-bind="    html: Message"></span>
                            <div class="commentFooter"> <span class="timeago" data-bind="text: CommentedDate"></span>&nbsp;</div>
                        </li>
                    </ul>
                    <div style="display: block" class="publishComment">
                        <textarea class="commentTextArea" data-bind="value: newCommentMessage, jqAutoresize: {}" placeholder="Write your reply..."></textarea>
                        <input type="button" value="Reply" class="btn blue" data-bind="click: addComment" />
                    </div>
                </div>
            </div>
        </li>
    </ul>
    @*</div>
        </div>*@



    <style>
        .msgTextArea {
            width: 100%;
            height: 80px;
            border-radius: 7px;
        }

        .commentTextArea {
            width: 93%;
            border-radius: 7px;
            height: 40px;
        }

        .publishContainer {
            width: 65%;
            text-align: right;
            background-color: #F2F2F2;
            border-color: #B4BBCD;
            border-image: none;
            border-style: solid;
            border-width: 1px;
            padding: 1em 1.2em;
            margin-bottom: 2em;
        }

        .publishComment {
            text-align: right;
            width: 100%;
            display: none;
        }

        #msgHolder {
            width: 65%;
        }

            #msgHolder img {
                float: left;
                margin-right: 7px;
            }

            #msgHolder a {
                text-decoration: none;
                color: #015BA7;
            }

                #msgHolder a:hover {
                    text-decoration: underline;
                }

        .postHolder {
            padding: 5px;
            border-bottom: solid 1px #E6E6E6;
            margin: 5px;
            list-style: none;
        }

            .postHolder p {
                margin: 4px auto 7px 50px;
            }

            .postHolder a {
                font-weight: bold;
            }

        .postFooter {
            font-size: 0.85em;
            margin-left: 55px;
        }

            .postFooter span {
                color: #7D7D84;
            }

            .postFooter a {
                font-weight: normal;
            }

        .commentHolder {
            clear: both;
            background-color: #EEF1F6;
            padding: 5px;
            border-bottom: 1px solid #DEE5EA;
            border-top: 1px solid white;
            list-style: none;
        }

        #btnShare, .btnComment, .btnRequest, .btn {
            background-color: #5B74A8;
            border: 0 none;
            color: #FFFFFF;
            cursor: pointer;
            font-size: 13px;
            font-weight: bold;
            margin-right: 10px;
            padding: 5px;
            text-align: center;
        }

        aside {
            float: right;
            width: 30%;
            font-size: 0.85em;
        }

            aside > div, #myConnections {
                border: solid 2px #3B5998;
                border-radius: 7px;
                float: left;
                width: 99%;
                margin-bottom: 5px;
            }

                aside h3, #myConnections h3 {
                    background-color: #3B5998;
                    color: White;
                    margin: 0px;
                    padding: 3px;
                    font-size: 0.95em;
                }

                aside a, #myConnections a {
                    text-decoration: none;
                    color: #015BA7;
                    font-weight: bold;
                }

                    aside a:hover, #myConnections a:hover {
                        text-decoration: underline;
                    }

                aside img, #myConnections img {
                    float: left;
                    margin-right: 7px;
                }

        .useritem {
            border-bottom: 1px solid #DEE5EA;
            clear: both;
            overflow: auto;
            padding: 3px;
        }

            .useritem p {
                margin: 4px auto 7px 55px;
            }

        .btnRequest, .btn {
            margin-top: 7px;
        }

        #myConnections {
            margin: 15px;
            width: 60%;
            font-size: 0.85em;
        }
    </style>
